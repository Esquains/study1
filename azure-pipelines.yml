# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

container:
  image: 308535385114.dkr.ecr.us-east-1.amazonaws.com/pytorch/pytorch-linux-trusty-py3.5:300
  endpoint: aws_docker

steps:
- script: echo Hello, world!
  displayName: 'Run a one-line script'

- script: |
    set +x
    export AWS_ACCESS_KEY_ID=${ECR_ACCESS_KEY}
    export AWS_SECRET_ACCESS_KEY=${ECR_SECRET}
    eval $(aws ecr get-login --region us-east-1 --no-include-email)
    
  displayName: 'Run a multi-line script'
